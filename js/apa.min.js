function APA(b){this.offset=0;this.duration=1000;this.loop=Infinity;this.easing=null;this.fps=60;this.path="";this.checkpoints={};this.speed=1;if(b){for(var a in b){if(b.hasOwnProperty(a)){this[a]=b[a]}}}this.init()}APA.prototype.init=function(){if(this.path){this.updatePath(this.path)}this.setFPS(this.fps||60);this.timer=null};APA.prototype.start=function(a){this.stop();this.progress=this.offset||0;if(!this.duration){return false}this.lastFrame=new Date();this.running=true;this.elapsed=0;this.update()};APA.prototype.update=function(){var d=this,a=new Date(),c=a-this.lastFrame,b;this.lastFrame=a;this.timer=setTimeout(function(){d.update()},this.dbf);if(!this.running){return}this.elapsed+=(c*this.speed);b=this.progress;this.progress=this.elapsed/this.duration;if(typeof this.easing=="function"){this.progress=this.easing(this.progress)}if(this.reverse){this.progress=this.offset-this.progress}else{this.progress+=this.offset}if(this.progress<0||this.progress>1){if(this.loop){if(typeof this.lap=="function"){this.lap.call(this)}if(this.loop!=Infinity){this.loop--}}else{this.stop();if(typeof this.finish=="function"){return this.finish.call(this)}}}this.angle=this.angleAt(this.progress);this.point=this.pointAt(this.progress);this.checkPoints(Math.min(this.progress,b),Math.max(this.progress,b));if(typeof this.step=="function"){this.step.call(this)}};APA.prototype.pause=function(){this.running=false};APA.prototype.resume=function(){this.running=true};APA.prototype.toggle=function(){this.running=!this.running};APA.prototype.stop=function(){clearTimeout(this.timer);this.timer=null;this.running=false};APA.prototype.checkPoints=function(d,b){var a;for(var c in this.checkpoints){if(this.checkpoints.hasOwnProperty(c)){a=this.checkpoints[c];if(c>=d&&c<b&&typeof a=="function"){a.call(this)}}}};APA.prototype.pointAt=function(a){return this.path.getPointAtLength(this.len*a)};APA.prototype.angleAt=function(a){var b=[this.pointAt(a-0.01),this.pointAt(a+0.01)];return Math.atan2(b[1].y-b[0].y,b[1].x-b[0].x)*180/Math.PI};APA.prototype.updatePath=function(a){if(typeof a=="string"){this.path=document.createElementNS("http://www.w3.org/2000/svg","path");this.path.setAttribute("d",a)}else{this.path=a}this.len=this.path.getTotalLength()};APA.prototype.addCheckpoint=function(b,a){this.checkpoints[b]=a};APA.prototype.setFPS=function(a){a=parseInt(a);if(a){this.fps=a;this.dbf=1000/a}};APA.prototype.setSpeed=function(a){this.speed=parseFloat(a)};
